"use strict";angular.module("eventures.loader",[]).provider("loaderProvider",function(){this.interceptableURL="/api",this.abeyance=200;var setInterceptableURL=function(url){this.interceptableURL=url},setAbeyance=function(abeyanceVal){this.abeyance=abeyanceVal};this.$get=function(){var interceptableURL=this.interceptableURL,abeyance=this.abeyance;return{setInterceptableURL:setInterceptableURL,setAbeyance:setAbeyance,interceptableURL:interceptableURL,abeyance:abeyance}}}).config(function($httpProvider){$httpProvider.interceptors.push("loaderInterceptor")}).factory("loaderInterceptor",function($rootScope,$q,$timeout,loaderProvider){var pendingRequests=0,checkUrl=function(config){return-1!=config.url.indexOf(loaderProvider.interceptableURL)?!0:!1};return{request:function(config){return checkUrl(config)&&(pendingRequests++,$timeout(function(){pendingRequests>0&&$rootScope.$broadcast("LOADER_START")},loaderProvider.abeyance)),config||$q.when(config)},response:function(response){return checkUrl(response.config)&&0===--pendingRequests&&$rootScope.$broadcast("LOADER_STOP"),response||$q.when(response)},responseError:function(response){return checkUrl(response.config)&&(--pendingRequests||$rootScope.$broadcast("LOADER_STOP")),$q.reject(response)}}}).directive("loader",function(){return{restrict:"AE",scope:{loader:"@"},link:function(scope,element){switch(element.css("display","none"),scope.loader){case"box":element.append('<div class="loader-box"></div>');break;case"bounce":element.append('<div class="loader-bounce"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>');break;case"cube":element.append('<div class="sk-cube-grid"><div class="sk-cube sk-cube1"></div><div class="sk-cube sk-cube2"></div><div class="sk-cube sk-cube3"></div><div class="sk-cube sk-cube4"></div><div class="sk-cube sk-cube5"></div><div class="sk-cube sk-cube6"></div><div class="sk-cube sk-cube7"></div><div class="sk-cube sk-cube8"></div><div class="sk-cube sk-cube9"></div></div>');break;case"spinner":element.append('<div class="spinner"><div class="dot1"></div><div class="dot2"></div></div>');break;case"fold":element.append('<div class="sk-folding-cube"><div class="sk-cube1 sk-cube"></div><div class="sk-cube2 sk-cube"></div><div class="sk-cube4 sk-cube"></div><div class="sk-cube3 sk-cube"></div></div>');break;default:element.append('<div class="loader-box"></div>')}},controller:function($scope,$element){$scope.$on("LOADER_START",function(){$element.css("display","block")}),$scope.$on("LOADER_STOP",function(){$element.css("display","none")})}}});